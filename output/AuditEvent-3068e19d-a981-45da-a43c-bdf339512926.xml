<?xml version="1.0" encoding="UTF-8"?>

<AuditEvent xmlns="http://hl7.org/fhir">
  <id value="3068e19d-a981-45da-a43c-bdf339512926"/>
  <meta>
    <profile value="https://dips.com/StructureDefinition/DIPS-AuditEvent-EHR"/>
  </meta>
  <text>
    <status value="additional"/><div xmlns="http://www.w3.org/1999/xhtml">This is an example of a create reservation event, but may as well be used in an Update or Delete action.</div>
  </text>
  <extension url="https://dips.com/StructureDefinition/CorrelationIDExtensionId">
    <valueString value="&lt;HTTP header correlation-ID&gt;"/>
  </extension>
  <type>
    <system value="https://dips.com/CodeSystem/dips-auditevent-types-cs"/>
    <code value="DIPS.IAM.Reservations"/>
  </type>
  <subtype>
    <system value="https://dips.com/CodeSystem/dips-auditevent-types-cs"/>
    <code value="DIPS.IAM.Reservations.Reservation"/>
  </subtype>
  <action value="C"/>
  <recorded value="2022-02-20T21:10:00+01:00"/>
  <outcome value="0"/>
  <agent>
    <who>
      <extension url="https://dips.com/StructureDefinition/OtherID">
        <valueIdentifier>
          <type>
            <coding>
              <system value="https://dips.com/CodeSystem/DIPSIDTypesCS"/>
              <code value="DIPSUserRoleID"/>
            </coding>
          </type>
          <value value="&lt;dips-userroleid&gt;"/>
        </valueIdentifier>
      </extension>
      <extension url="https://dips.com/StructureDefinition/OtherID">
        <valueIdentifier>
          <type>
            <coding>
              <system value="https://dips.com/CodeSystem/DIPSIDTypesCS"/>
              <code value="DIPSUserName"/>
            </coding>
          </type>
          <value value="&lt;dips-usernamed&gt;"/>
        </valueIdentifier>
      </extension>
      <identifier>
        <value value="&lt;sub-attribute&gt;"/>
      </identifier>
    </who>
    <requestor value="true"/>
    <policy value="985ad665-97fc-4c37-9b17-4da7dcca3d15"/>
    <network>
      <address value="&lt;IP-address user device if available&gt;"/>
      <type value="2"/>
    </network>
  </agent>
  <source>
    <observer>
      <identifier>
        <type>
          <coding>
            <system value="https://dips.com/CodeSystem/DIPSIDTypesCS"/>
            <code value="FQN"/>
          </coding>
        </type>
        <value value="&lt;Fully qualified type name&gt;"/>
      </identifier>
    </observer>
  </source>
  <entity>
    <what>
      <identifier>
        <type>
          <coding>
            <system value="https://dips.com/CodeSystem/DIPSIDTypesCS"/>
            <code value="DIPSPersonID"/>
          </coding>
        </type>
        <value value="&lt;DIPS PasientID&gt;"/>
      </identifier>
    </what>
    <type>
      <system value="http://terminology.hl7.org/CodeSystem/audit-entity-type"/>
      <code value="1"/>
      <display value="Person"/>
    </type>
    <role>
      <system value="http://terminology.hl7.org/CodeSystem/object-role"/>
      <code value="1"/>
    </role>
  </entity>
  <entity>
    <what>
      <identifier>
        <type>
          <coding>
            <system value="https://dips.com/CodeSystem/DIPSIDTypesCS"/>
            <code value="Reservation"/>
          </coding>
        </type>
        <system value="urn:ietf:rfc:3986"/>
        <value value="&lt;ReservationUUID&gt;"/>
      </identifier>
    </what>
    <type>
      <system value="http://terminology.hl7.org/CodeSystem/audit-entity-type"/>
      <code value="2"/>
    </type>
  </entity>
  <entity>
    <what>
      <identifier>
        <type>
          <coding>
            <system value="https://dips.com/CodeSystem/DIPSIDTypesCS"/>
            <code value="ReservationChangeLog"/>
          </coding>
        </type>
        <system value="urn:ietf:rfc:3986"/>
        <value value="&lt;ChangeLogUUID&gt;"/>
      </identifier>
    </what>
    <type>
      <system value="http://terminology.hl7.org/CodeSystem/audit-entity-type"/>
      <code value="2"/>
    </type>
  </entity>
</AuditEvent>